<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Surface Pen Writing App</title>
    
    <!-- PWA Manifest -->
    <link rel="manifest" href="data:application/json;base64,ewogICJuYW1lIjogIlN1cmZhY2UgUGVuIFdyaXRpbmcgQXBwIiwKICAic2hvcnRfbmFtZSI6ICJQZW5BcHAiLAogICJzdGFydF91cmwiOiAiLyIsCiAgImRpc3BsYXkiOiAic3RhbmRhbG9uZSIsCiAgImJhY2tncm91bmRfY29sb3IiOiAiI2ZmZmZmZiIsCiAgInRoZW1lX2NvbG9yIjogIiNmZmZmZmYiLAogICJpY29ucyI6IFsKICAgIHsKICAgICAgInNyYyI6ICJkYXRhOmltYWdlL3N2Zyt4bWw7YmFzZTY0LFBITjJaeUI0Yld4dWN6MGlhSFIwY0RvdkwzZDNkeTUzTXk1dmNtY3ZNakF3TUM5emRtY2lJR2hwWldkb2REMGlNVEk0SWlCM2FXUjBhRDBpTVRJNElpQjJhV1YzUW05NFBTSXdJREFnTVRJNElERTlJaUJtYVd4c1BTSWpabVptWm1abUlqNDhjbVZqZENCM2FXUjBhRDBpTVRJNElpQm9aV2xuYUhROUlqRXlPQ0lnWm1sc2JEMGlJMlptWm1abUlpOCtQQzl6ZG1jKyIsCiAgICAgICJzaXplcyI6ICIxMjh4MTI4IiwKICAgICAgInR5cGUiOiAiaW1hZ2Uvc3ZnK3htbCIKICAgIH0KICBdCn0=">
    
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        html, body {
            height: 100%;
            width: 100%;
            background-color: white;
            overflow: hidden;
            touch-action: none;
            user-select: none;
            font-family: Arial, sans-serif;
        }

        .container {
            display: flex;
            width: 100vw;
            height: 100vh;
        }

        .sidebar {
            width: 15%;
            height: 100vh;
            background-color: #f5f5f5;
            border-right: 1px solid #ddd;
            transform: translateX(-100%);
            transition: transform 0.3s ease;
            position: relative;
            z-index: 10;
        }

        .sidebar.open {
            transform: translateX(0);
        }

        .canvas-container {
            flex: 1;
            position: relative;
            background-color: white;
        }

        #canvas {
            display: block;
            background-color: white;
            cursor: crosshair;
            width: 100%;
            height: 100%;
        }

        .menu-toggle {
            position: absolute;
            top: 20px;
            left: 20px;
            z-index: 20;
            background-color: #333;
            color: white;
            border: none;
            padding: 10px 15px;
            border-radius: 5px;
            cursor: pointer;
            font-size: 16px;
        }

        .menu-toggle:hover {
            background-color: #555;
        }

        .sidebar-content {
            padding: 60px 20px 20px 20px;
            height: 100%;
        }

        .sidebar h3 {
            margin-bottom: 20px;
            color: #333;
        }
    </style>
</head>
<body>
    <div class="container">
        <div class="sidebar" id="sidebar">
            <div class="sidebar-content">
                <h3>Tools</h3>
            </div>
        </div>
        
        <div class="canvas-container">
            <button class="menu-toggle" id="menuToggle">â˜°</button>
            <canvas id="canvas"></canvas>
        </div>
    </div>

    <script>
        const canvas = document.getElementById('canvas');
        const ctx = canvas.getContext('2d');
        const sidebar = document.getElementById('sidebar');
        const menuToggle = document.getElementById('menuToggle');

        // Toggle sidebar
        menuToggle.addEventListener('click', () => {
            sidebar.classList.toggle('open');
        });

        // Close sidebar when clicking on canvas
        canvas.addEventListener('click', () => {
            if (sidebar.classList.contains('open')) {
                sidebar.classList.remove('open');
            }
        });

        // Set canvas size
        function resizeCanvas() {
            const dpr = window.devicePixelRatio || 1;
            const rect = canvas.getBoundingClientRect();
            
            canvas.width = rect.width * dpr;
            canvas.height = rect.height * dpr;
            
            ctx.scale(dpr, dpr);
            ctx.lineCap = 'round';
            ctx.lineJoin = 'round';
            ctx.strokeStyle = '#000000';
            ctx.lineWidth = 2;
        }

        resizeCanvas();
        
        let isDrawing = false;
        let points = [];

        function getPoint(e) {
            const rect = canvas.getBoundingClientRect();
            const clientX = e.clientX || (e.touches && e.touches[0] ? e.touches[0].clientX : 0);
            const clientY = e.clientY || (e.touches && e.touches[0] ? e.touches[0].clientY : 0);
            
            return {
                x: clientX - rect.left,
                y: clientY - rect.top
            };
        }

        function startDraw(e) {
            // Don't draw if clicking on menu toggle
            if (e.target === menuToggle) return;
            
            e.preventDefault();
            isDrawing = true;
            points = [getPoint(e)];
        }

        function draw(e) {
            if (!isDrawing) return;
            e.preventDefault();
            
            const point = getPoint(e);
            points.push(point);
            
            if (points.length >= 2) {
                const lastPoint = points[points.length - 2];
                
                ctx.beginPath();
                ctx.moveTo(lastPoint.x, lastPoint.y);
                ctx.lineTo(point.x, point.y);
                ctx.stroke();
            }
        }

        function stopDraw(e) {
            if (isDrawing) {
                e.preventDefault();
                isDrawing = false;
                points = [];
            }
        }

        // Mouse events
        canvas.addEventListener('mousedown', startDraw);
        canvas.addEventListener('mousemove', draw);
        canvas.addEventListener('mouseup', stopDraw);
        canvas.addEventListener('mouseleave', stopDraw);

        // Touch events
        canvas.addEventListener('touchstart', startDraw);
        canvas.addEventListener('touchmove', draw);
        canvas.addEventListener('touchend', stopDraw);
        canvas.addEventListener('touchcancel', stopDraw);

        // Prevent scrolling and zooming
        document.addEventListener('touchmove', (e) => {
            if (e.target === canvas) {
                e.preventDefault();
            }
        }, { passive: false });
        
        document.addEventListener('wheel', (e) => e.preventDefault(), { passive: false });

        // Resize handler
        window.addEventListener('resize', resizeCanvas);

        // PWA service worker
        if ('serviceWorker' in navigator) {
            navigator.serviceWorker.register('data:text/javascript;base64,c2VsZi5hZGRFdmVudExpc3RlbmVyKCdpbnN0YWxsJywgKCkgPT4gc2VsZi5za2lwV2FpdGluZygpKTtzZWxmLmFkZEV2ZW50TGlzdGVuZXIoJ2ZldGNoJywgZSA9PiBlLnJlc3BvbmRXaXRoKGZldGNoKGUucmVxdWVzdCkpKTs=');
        }
    </script>
</body>
</html>
